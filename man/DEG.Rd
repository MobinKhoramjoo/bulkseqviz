% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/DEG.R
\name{DEG}
\alias{DEG}
\title{Calculate Differential Expression Results}
\usage{
DEG(
  bs_obj,
  design_col,
  compare_levels,
  covariates = NULL,
  min_count = 10,
  padj_cutoff = 1,
  log2fc_cutoff = 0,
  biomart_dataset = "hsapiens_gene_ensembl",
  id_type = "ensembl_gene_id",
  output_dir = NULL
)
}
\arguments{
\item{bs_obj}{A \code{bulkseq} object created by \code{create_bulkseqvis_object}.}

\item{design_col}{Character string. The metadata column to use for the design formula (e.g., "condition").}

\item{compare_levels}{Character vector of length 2. The levels to compare in the format c("Treatment", "Control").}

\item{covariates}{Character vector. Optional. Additional metadata columns to include in the design formula.}

\item{min_count}{Integer. Minimum total counts per gene to keep. Default 10.}

\item{padj_cutoff}{Numeric. Filter output for padj < this value (for console summary). Default 1.}

\item{log2fc_cutoff}{Numeric. Filter output for |log2FC| > this value (for console summary). Default 0.}

\item{biomart_dataset}{Character string. The BioMart dataset to use (e.g., "hsapiens_gene_ensembl"). If NULL, annotation is skipped.}

\item{id_type}{Character string. The type of gene ID in the count matrix rownames (e.g., "ensembl_gene_id").}

\item{output_dir}{Character string. Optional. Path to save CSV/rank files. If NULL, files are not saved.}
}
\value{
An updated \code{bulkseq} object with results stored in \code{obj$DE_results}.
}
\description{
Performs differential expression analysis using DESeq2 and stores the results
in the bulkseq object. Optionally fetches gene annotations via BioMart.
}
\examples{
\dontrun{
  # Basic DE analysis
  bs_obj <- DEG(bs_obj, design_col = "condition",
                compare_levels = c("Treated", "Control"))

  # With BioMart annotation and file saving
  bs_obj <- DEG(bs_obj, design_col = "condition",
                compare_levels = c("Treated", "Control"),
                biomart_dataset = "hsapiens_gene_ensembl",
                output_dir = "./results")
}
}
